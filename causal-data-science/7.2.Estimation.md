- [Table of Contents](#table-of-contents)
  - [Estimands for binary treatments](#estimands-for-binary-treatments)
    - [Average Treatment Effects (ATE)](#average-treatment-effects-ate)
    - [Average Treatment Effects on the Treated](#average-treatment-effects-on-the-treated)
    - [Average Treatment Effects on the Controlled](#average-treatment-effects-on-the-controlled)
  - [Estimation Methods](#estimation-methods)
    - [Matching](#matching)
      - [Covariate Balancing](#covariate-balancing)
      - [Exact Matching](#exact-matching)
      - [Soft Matching](#soft-matching)
    - [Propensity score](#propensity-score)
      - [Propensity score matching (PSM)](#propensity-score-matching-psm)
      - [Inverse probability weighting](#inverse-probability-weighting)


# Table of Contents

## Estimands for binary treatments
### Average Treatment Effects (ATE)
ATE = E[Y(t=1) - Y(t=0)] = E[Y|do(T=1)] - E[Y|do(T=0)]

### Average Treatment Effects on the Treated 
ATT = E[Y(t=1) - Y(t=0) | T=1]

### Average Treatment Effects on the Controlled 
ATT = E[Y(t=1) - Y(t=0) | T=0]

## Estimation Methods
### Matching 
#### Covariate Balancing 
$T \perp \!\!\! \perp Z \equiv P(Z| T=0) = P(Z|T=1)$

#### Exact Matching 
- Units with same value X=x in each group are the same (ignore other attributes)
- Discard unmatched units, so we have the same number of units with the same combination of values for X in  treatment and control (balancing)

> pick one from treatment group and one from control group so that they have the same X. continue to do it until on group run out of units of the same value

#### Soft Matching 
- Using distance: Mahalanobis Distance
- Need to check covariate balancing after matching (e.g. std, mean difference)
  - $T \perp \!\!\! \perp X \equiv P(X| T=0) = P(X|T=1)$


### Propensity score
#### Propensity score matching (PSM)
- Assumption: binary treatment T, X is valid adjustment set
- Propensity Score: the probability of getting assigned the treatment -> compute $P(T=1|X)$ for each value of $X$
  - $\pi$ := P(T=1 | X=x)

#### Inverse probability weighting
- For treated T=1: weight by the inverse of  
  - π= P(T = 1|X=x)
- For untreated T=0: weight by the inverse of  
  - 1 - π= P(T = 0|X=x)

$$
\begin{aligned}
&E(Y(t=1)) = \frac{1}{n} \sum_{i=1}^{n}Y_{i}*1\{{T=1}\}*\frac{1}{P(T=1|X_{i})} \\
&E(Y(t=0)) = \frac{1}{n} \sum_{i=1}^{n}Y_{i}*1\{{T=0}\}*\frac{1}{1-P(T=1|X_{i})} \\
&ATT(ATE) =  E(Y(t=1)) - E(Y(t=0))
\end{aligned}
$$

